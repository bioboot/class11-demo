---
title: "Class 11 Section 3 Onward"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Bio3D Class 11

If you dont have the [bio3d package](http://thegrantlab.org/bio3d/) available then you will need to do a one-time-only install from within R like so:

```{r, eval=FALSE}
install.packages("bio3d")
```


NOw we are sure wi have the package lets load it and read some PDB files for analysis. Note in the code-block below we can add the option `warning=FALSE` to trun off the printing of the warning msg about files already existing.

```{r, warning=FALSE, results='hide'}
library(bio3d)

# Download some example PDB files 
ids <- c("1TND_B","1AGR_A","1TAG_A","1GG2_A","1KJY_A","4G5Q_A")
files <- get.pdb(ids, split = TRUE)
```

Lets align these structures with the `pdbaln()` function and print a summary of the output.

```{r}
# Extract and align the chains we are interested in  
pdbs <- pdbaln(files, fit = TRUE)
pdbs
```

I wonder how this call will work

```{r}
aln2html(pdbs)
```

Can we see the results [alignment.html](alignment.html)


### Sequence analysis

Lets try some basic things...

```{r}
# Calculate sequence 
identity <- seqidentity(pdbs)
identity
```

